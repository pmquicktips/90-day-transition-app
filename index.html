<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>90-Day SME to PM Transition Roadmap</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fraunces:wght@700;900&family=IBM+Plex+Sans:wght@400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #1a4d7a;
            --primary-light: #2e75b6;
            --secondary: #44546a;
            --accent: #c55a11;
            --success: #70ad47;
            --warning: #ffc000;
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #1a1a1a;
            --text-light: #6b7280;
            --border: #e5e7eb;
        }
        
        body {
            font-family: 'IBM Plex Sans', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 2rem 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            font-family: 'Fraunces', serif;
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: -0.02em;
            margin-bottom: 0.5rem;
        }
        
        .tagline {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        /* Container */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        /* Progress Bar */
        .progress-section {
            background: var(--card);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            margin-bottom: 2rem;
        }
        
        .progress-bar {
            background: var(--border);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 1rem;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--success) 0%, var(--primary-light) 100%);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }
        
        /* Navigation */
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
            margin-bottom: 2rem;
        }
        
        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s ease;
        }
        
        .nav-tab:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .nav-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Cards */
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border-left: 4px solid var(--primary-light);
        }
        
        .card h2 {
            font-family: 'Fraunces', serif;
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.75rem;
        }
        
        .card h3 {
            color: var(--secondary);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 1.25rem;
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--secondary);
        }
        
        input[type="text"],
        input[type="number"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }
        
        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-light);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 117, 182, 0.3);
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        th, td {
            padding: 0.75rem;
            border: 1px solid var(--border);
            text-align: left;
        }
        
        th {
            background: var(--bg);
            font-weight: 600;
            color: var(--secondary);
        }
        
        tr:hover {
            background: var(--bg);
        }
        
        /* Level Badges */
        .level-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            margin: 0.5rem 0;
        }
        
        .level-1 { background: #fee2e2; color: #991b1b; }
        .level-2 { background: #fef3c7; color: #92400e; }
        .level-3 { background: #dbeafe; color: #1e40af; }
        .level-4 { background: #d1fae5; color: #065f46; }
        .level-5 { background: #e9d5ff; color: #6b21a8; }
        
        /* Checklist */
        .checklist {
            list-style: none;
        }
        
        .checklist-item {
            padding: 0.75rem;
            margin: 0.5rem 0;
            background: var(--bg);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .checklist-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }
        
        /* Alert Boxes */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #dbeafe;
            border-color: #2563eb;
            color: #1e40af;
        }
        
        .alert-warning {
            background: #fef3c7;
            border-color: #f59e0b;
            color: #92400e;
        }
        
        .alert-success {
            background: #d1fae5;
            border-color: #10b981;
            color: #065f46;
        }
        
        /* Hidden class */
        .hidden {
            display: none;
        }
        
        /* Save indicator */
        .save-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--success);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 1.5rem;
            }
            
            .nav-tab {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>90-Day Transition Roadmap</h1>
            <div class="tagline">From Subject Matter Expert to Project Manager</div>
        </div>
    </div>
    
    <div class="container">
        <!-- Progress Section -->
        <div class="progress-section">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>Your Progress</strong>
                    <div id="dayCounter" style="color: var(--primary); font-size: 1.25rem; margin-top: 0.25rem;">Day 0 of 90</div>
                </div>
                <div id="progressPercent" style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">0%</div>
            </div>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showSection('assessment')">Assessment</div>
            <div class="nav-tab" onclick="showSection('priorities')">Priorities</div>
            <div class="nav-tab" onclick="showSection('month1')">Days 1-30</div>
            <div class="nav-tab" onclick="showSection('month2')">Days 31-60</div>
            <div class="nav-tab" onclick="showSection('month3')">Days 61-90</div>
            <div class="nav-tab" onclick="showSection('evaluation')">Evaluation</div>
            <div class="nav-tab" onclick="showSection('quickref')">Quick Ref</div>
        </div>
        
        <!-- SECTION: ASSESSMENT -->
        <div id="assessment" class="section">
            <div class="card">
                <h2>üìä Assessment Results</h2>
                <p>Complete the SME to PM Transition Assessment, then enter your results here.</p>
                
                <div class="form-group">
                    <label>Assessment Date</label>
                    <input type="date" id="assessmentDate" onchange="saveData()">
                </div>
                
                <div class="form-group">
                    <label>Total Score (out of 50)</label>
                    <input type="number" id="totalScore" min="10" max="50" onchange="calculateLevel()" placeholder="Enter your total score">
                </div>
                
                <div id="levelDisplay" class="hidden">
                    <h3>Your Readiness Level</h3>
                    <div id="levelBadge"></div>
                    <div id="levelGuidance" class="alert alert-info" style="margin-top: 1rem;"></div>
                </div>
                
                <h3>Individual Question Scores</h3>
                <p style="color: var(--text-light); margin-bottom: 1rem;">Questions where you scored 1-2 should become priority focus areas.</p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Question</th>
                            <th style="width: 100px;">Score (1-5)</th>
                            <th style="width: 120px;">Priority?</th>
                        </tr>
                    </thead>
                    <tbody id="questionsTable">
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- SECTION: PRIORITIES -->
        <div id="priorities" class="section hidden">
            <div class="card">
                <h2>üéØ Your Top 3 Priorities</h2>
                
                <h3>Priority 1: Biggest Development Need</h3>
                <div class="form-group">
                    <label>What skill/behavior needs the most improvement?</label>
                    <textarea id="priority1_skill" onchange="saveData()" placeholder="E.g., I need to stop jumping into technical work and let my team struggle through problems..."></textarea>
                </div>
                <div class="form-group">
                    <label>What will success look like in 90 days?</label>
                    <textarea id="priority1_success" onchange="saveData()" placeholder="E.g., My team solves technical problems independently without needing me..."></textarea>
                </div>
                
                <h3>Priority 2: Quick Win</h3>
                <div class="form-group">
                    <label>What can you improve quickly for visible impact?</label>
                    <textarea id="priority2_quickwin" onchange="saveData()" placeholder="E.g., Establish weekly 1-on-1s with each team member..."></textarea>
                </div>
                
                <h3>Priority 3: Team Development</h3>
                <div class="form-group">
                    <label>Who needs development? What capability are you building?</label>
                    <textarea id="priority3_team" onchange="saveData()" placeholder="E.g., Sarah needs to develop leadership skills - I'll have her lead the next sprint planning..."></textarea>
                </div>
            </div>
        </div>
        
        <!-- SECTION: MONTH 1 -->
        <div id="month1" class="section hidden">
            <div class="card">
                <h2>üìÖ Days 1-30: Foundation</h2>
                
                <h3>Week 1: Assessment & Communication</h3>
                <ul class="checklist" id="week1Checklist">
                    <!-- Will be populated by JavaScript -->
                </ul>
                
                <h3>Week 2-3: Delegation</h3>
                <p>Track your delegation efforts:</p>
                <table>
                    <thead>
                        <tr>
                            <th>Task to Delegate</th>
                            <th>Assigned To</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="text" id="delegate1_task" onchange="saveData()"></td>
                            <td><input type="text" id="delegate1_person" onchange="saveData()"></td>
                            <td><input type="text" id="delegate1_result" onchange="saveData()"></td>
                        </tr>
                        <tr>
                            <td><input type="text" id="delegate2_task" onchange="saveData()"></td>
                            <td><input type="text" id="delegate2_person" onchange="saveData()"></td>
                            <td><input type="text" id="delegate2_result" onchange="saveData()"></td>
                        </tr>
                        <tr>
                            <td><input type="text" id="delegate3_task" onchange="saveData()"></td>
                            <td><input type="text" id="delegate3_person" onchange="saveData()"></td>
                            <td><input type="text" id="delegate3_result" onchange="saveData()"></td>
                        </tr>
                    </tbody>
                </table>
                
                <h3 style="margin-top: 2rem;">Week 4: Month 1 Evaluation</h3>
                <div class="form-group">
                    <label>Time allocation - Technical: ___% | PM: ___% | Strategic: ___%</label>
                    <input type="text" id="month1_time" onchange="saveData()" placeholder="E.g., 40% / 40% / 20%">
                </div>
                <div class="form-group">
                    <label>What will you do differently in Month 2?</label>
                    <textarea id="month1_improve" onchange="saveData()"></textarea>
                </div>
            </div>
        </div>
        
        <!-- SECTION: MONTH 2 -->
        <div id="month2" class="section hidden">
            <div class="card">
                <h2>üìà Days 31-60: Development</h2>
                
                <h3>Team Development Focus</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Team Member</th>
                            <th>Strength to Leverage</th>
                            <th>Development Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="text" id="team1_name" onchange="saveData()"></td>
                            <td><input type="text" id="team1_strength" onchange="saveData()"></td>
                            <td><input type="text" id="team1_action" onchange="saveData()"></td>
                        </tr>
                        <tr>
                            <td><input type="text" id="team2_name" onchange="saveData()"></td>
                            <td><input type="text" id="team2_strength" onchange="saveData()"></td>
                            <td><input type="text" id="team2_action" onchange="saveData()"></td>
                        </tr>
                        <tr>
                            <td><input type="text" id="team3_name" onchange="saveData()"></td>
                            <td><input type="text" id="team3_strength" onchange="saveData()"></td>
                            <td><input type="text" id="team3_action" onchange="saveData()"></td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Process Improvements</h3>
                <div class="form-group">
                    <label>Bottleneck identified & fixed:</label>
                    <textarea id="month2_bottleneck" onchange="saveData()"></textarea>
                </div>
                <div class="form-group">
                    <label>Communication improvement:</label>
                    <textarea id="month2_communication" onchange="saveData()"></textarea>
                </div>
            </div>
        </div>
        
        <!-- SECTION: MONTH 3 -->
        <div id="month3" class="section hidden">
            <div class="card">
                <h2>üéØ Days 61-90: Refinement</h2>
                
                <h3>Advanced Delegation</h3>
                <div class="form-group">
                    <label>Significant responsibility to hand off completely:</label>
                    <textarea id="month3_responsibility" onchange="saveData()"></textarea>
                </div>
                <div class="form-group">
                    <label>Who takes it? What support do they need?</label>
                    <textarea id="month3_support" onchange="saveData()"></textarea>
                </div>
                
                <h3>Culture & Sustainability</h3>
                <ul class="checklist" id="cultureChecklist">
                    <!-- Will be populated by JavaScript -->
                </ul>
            </div>
        </div>
        
        <!-- SECTION: EVALUATION -->
        <div id="evaluation" class="section hidden">
            <div class="card">
                <h2>üìä 90-Day Evaluation</h2>
                
                <div class="alert alert-info">
                    Complete this section at Day 90 to measure your progress!
                </div>
                
                <h3>Quantitative Progress</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Activity</th>
                            <th>Day 1 %</th>
                            <th>Day 90 %</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Technical work</td>
                            <td><input type="number" id="eval_tech_start" onchange="saveData()" style="width: 80px;"></td>
                            <td><input type="number" id="eval_tech_end" onchange="saveData()" style="width: 80px;"></td>
                        </tr>
                        <tr>
                            <td>PM work</td>
                            <td><input type="number" id="eval_pm_start" onchange="saveData()" style="width: 80px;"></td>
                            <td><input type="number" id="eval_pm_end" onchange="saveData()" style="width: 80px;"></td>
                        </tr>
                        <tr>
                            <td>Strategic thinking</td>
                            <td><input type="number" id="eval_strat_start" onchange="saveData()" style="width: 80px;"></td>
                            <td><input type="number" id="eval_strat_end" onchange="saveData()" style="width: 80px;"></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="form-group" style="margin-top: 2rem;">
                    <label>Retake assessment - New Score (out of 50):</label>
                    <input type="number" id="eval_newscore" min="10" max="50" onchange="saveData()">
                </div>
                
                <h3>Reflection</h3>
                <div class="form-group">
                    <label>Behavior change you're most proud of:</label>
                    <textarea id="eval_proud" onchange="saveData()"></textarea>
                </div>
                <div class="form-group">
                    <label>What was harder than expected:</label>
                    <textarea id="eval_hard" onchange="saveData()"></textarea>
                </div>
                <div class="form-group">
                    <label>How has your team responded:</label>
                    <textarea id="eval_team" onchange="saveData()"></textarea>
                </div>
            </div>
        </div>
        
        <!-- SECTION: QUICK REFERENCE -->
        <div id="quickref" class="section hidden">
            <div class="card">
                <h2>üìö Quick Reference Guide</h2>
                
                <h3>‚ö†Ô∏è Warning Signs You're Reverting to SME Mode</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Working significantly more hours than your team</li>
                    <li>Solving technical problems instead of guiding solutions</li>
                    <li>Haven't delegated anything significant in 2 weeks</li>
                    <li>Checking in on delegated work multiple times daily</li>
                    <li>Can't articulate strategic work you did this week</li>
                </ul>
                
                <h3>üîÑ Emergency Reset Protocol</h3>
                <div class="alert alert-warning">
                    <strong>If you've slipped back into SME mode:</strong>
                    <ol style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Acknowledge it without judgment - this is normal</li>
                        <li>Identify the trigger - what caused the regression?</li>
                        <li>Re-delegate the technical work you took back</li>
                        <li>Block 2 hours for strategic thinking immediately</li>
                        <li>Recommit to one specific PM behavior this week</li>
                    </ol>
                </div>
                
                <h3>‚úì Weekly Check-In Questions</h3>
                <p style="margin-bottom: 1rem;">Ask yourself these every Friday:</p>
                <ul class="checklist">
                    <li class="checklist-item">
                        <input type="checkbox"> Delegated 2+ significant tasks this week?
                    </li>
                    <li class="checklist-item">
                        <input type="checkbox"> Spent 50%+ time on PM/strategic work?
                    </li>
                    <li class="checklist-item">
                        <input type="checkbox"> Resisted taking over when team struggled?
                    </li>
                    <li class="checklist-item">
                        <input type="checkbox"> Created a learning opportunity for someone?
                    </li>
                    <li class="checklist-item">
                        <input type="checkbox"> Communicated project vision clearly?
                    </li>
                </ul>
                
                <div class="alert alert-success" style="margin-top: 2rem;">
                    <strong>Remember:</strong> This transition is a journey, not a destination. Setbacks are normal. 
                    What matters is recognizing regression, learning from it, and course-correcting. 
                    Every week you practice leadership, it becomes more natural. You have the plan‚Äînow execute it. 
                    Your team is counting on you. üöÄ
                </div>
            </div>
        </div>
        
        <!-- Export Button -->
        <div style="text-align: center; margin: 3rem 0;">
            <button class="btn btn-primary" onclick="exportData()">üì• Export Your Progress</button>
            <button class="btn btn-secondary" onclick="clearAllData()" style="margin-left: 1rem;">üîÑ Reset All Data</button>
        </div>
    </div>
    
    <!-- Save Indicator -->
    <div id="saveIndicator" class="save-indicator">‚úì Progress saved</div>
    
    <script>
        // Questions data
        const questions = [
            "I regularly delegate tasks to my team",
            "I focus on leading rather than executing",
            "I empower my team to make decisions",
            "I provide guidance vs micromanaging",
            "I communicate project goals effectively",
            "I make strategic vs tactical decisions",
            "I recognize when I slip into technical work",
            "I create team skill development opportunities",
            "I use PM tools to track progress",
            "I set measurable objectives"
        ];
        
        // Week 1 checklist items
        const week1Items = [
            "Complete team skills assessment for each member",
            "Communicate your PM transition to team",
            "Identify 5 tasks to stop doing personally"
        ];
        
        // Culture checklist items
        const cultureItems = [
            "Team learning ritual established",
            "Recognition practice in place",
            "Feedback mechanism created",
            "Problem-solving approach defined"
        ];
        
        // Level definitions
        const levels = {
            1: {
                name: "Technical Expert",
                range: "10-14",
                class: "level-1",
                guidance: "Focus: Stop doing technical work. Delegate 2-3 tasks/week. Block 3 hours weekly for strategic thinking. Over-communicate project vision."
            },
            2: {
                name: "Emerging Leader",
                range: "15-24",
                class: "level-2",
                guidance: "Focus: Build consistent delegation habits. Shift from solving to guiding. Establish clear boundaries on technical involvement."
            },
            3: {
                name: "Defined PM",
                range: "25-34",
                class: "level-3",
                guidance: "Focus: Embrace PM identity fully. Delegate challenging work, not just routine tasks. Increase strategic planning time significantly."
            },
            4: {
                name: "Managed PM",
                range: "35-44",
                class: "level-4",
                guidance: "Focus: Refine delegation quality. Deepen strategic thinking. Build team capability to operate independently without you."
            },
            5: {
                name: "Optimized Leader",
                range: "45-50",
                class: "level-5",
                guidance: "Focus: Mentor other transitioning SMEs. Drive organizational leadership development. Expand strategic impact beyond your team."
            }
        };
        
        // Initialize app
        function initializeApp() {
            populateQuestionsTable();
            populateChecklists();
            loadData();
            updateProgress();
        }
        
        // Populate questions table
        function populateQuestionsTable() {
            const tbody = document.getElementById('questionsTable');
            questions.forEach((q, i) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>Q${i+1}: ${q}</td>
                    <td><input type="number" id="q${i+1}" min="1" max="5" onchange="calculateLevel(); saveData()" style="width: 60px;"></td>
                    <td><input type="checkbox" id="q${i+1}_priority" onchange="saveData()"></td>
                `;
            });
        }
        
        // Populate checklists
        function populateChecklists() {
            const week1 = document.getElementById('week1Checklist');
            week1Items.forEach((item, i) => {
                const li = document.createElement('li');
                li.className = 'checklist-item';
                li.innerHTML = `<input type="checkbox" id="week1_${i}" onchange="toggleComplete(this); saveData()"> ${item}`;
                week1.appendChild(li);
            });
            
            const culture = document.getElementById('cultureChecklist');
            cultureItems.forEach((item, i) => {
                const li = document.createElement('li');
                li.className = 'checklist-item';
                li.innerHTML = `<input type="checkbox" id="culture_${i}" onchange="toggleComplete(this); saveData()"> ${item}`;
                culture.appendChild(li);
            });
        }
        
        // Toggle checklist item completion
        function toggleComplete(checkbox) {
            checkbox.parentElement.classList.toggle('completed', checkbox.checked);
        }
        
        // Calculate level based on total score
        function calculateLevel() {
            const score = parseInt(document.getElementById('totalScore').value) || 0;
            
            if (score === 0) {
                document.getElementById('levelDisplay').classList.add('hidden');
                return;
            }
            
            let level = 1;
            if (score >= 45) level = 5;
            else if (score >= 35) level = 4;
            else if (score >= 25) level = 3;
            else if (score >= 15) level = 2;
            
            const levelInfo = levels[level];
            document.getElementById('levelDisplay').classList.remove('hidden');
            document.getElementById('levelBadge').innerHTML = 
                `<span class="level-badge ${levelInfo.class}">Level ${level}: ${levelInfo.name} (${levelInfo.range} points)</span>`;
            document.getElementById('levelGuidance').textContent = levelInfo.guidance;
            
            saveData();
        }
        
        // Show section
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        // Update progress
        function updateProgress() {
            const startDate = localStorage.getItem('startDate');
            if (!startDate) return;
            
            const start = new Date(startDate);
            const now = new Date();
            const daysPassed = Math.floor((now - start) / (1000 * 60 * 60 * 24));
            const daysElapsed = Math.min(daysPassed, 90);
            const percentComplete = Math.round((daysElapsed / 90) * 100);
            
            document.getElementById('dayCounter').textContent = `Day ${daysElapsed} of 90`;
            document.getElementById('progressPercent').textContent = `${percentComplete}%`;
            document.getElementById('progressFill').style.width = `${percentComplete}%`;
        }
        
        // Save data to localStorage
        async function saveData() {
            const data = {};
            
            // Get all inputs
            document.querySelectorAll('input, textarea, select').forEach(el => {
                if (el.id) {
                    if (el.type === 'checkbox') {
                        data[el.id] = el.checked;
                    } else {
                        data[el.id] = el.value;
                    }
                }
            });
            
            // Set start date if assessment date is filled
            const assessmentDate = document.getElementById('assessmentDate').value;
            if (assessmentDate && !localStorage.getItem('startDate')) {
                localStorage.setItem('startDate', assessmentDate);
                updateProgress();
            }
            
            // Save to persistent storage
            try {
                await window.storage.set('transition-plan-data', JSON.stringify(data));
                showSaveIndicator();
            } catch (error) {
                // Fallback to localStorage
                localStorage.setItem('transitionPlanData', JSON.stringify(data));
                showSaveIndicator();
            }
        }
        
        // Load data from storage
        async function loadData() {
            try {
                const result = await window.storage.get('transition-plan-data');
                const data = result ? JSON.parse(result.value) : null;
                
                if (!data) {
                    // Try localStorage fallback
                    const localData = localStorage.getItem('transitionPlanData');
                    if (localData) {
                        restoreData(JSON.parse(localData));
                    }
                    return;
                }
                
                restoreData(data);
            } catch (error) {
                // Fallback to localStorage
                const localData = localStorage.getItem('transitionPlanData');
                if (localData) {
                    restoreData(JSON.parse(localData));
                }
            }
        }
        
        // Restore data to form
        function restoreData(data) {
            Object.keys(data).forEach(key => {
                const el = document.getElementById(key);
                if (el) {
                    if (el.type === 'checkbox') {
                        el.checked = data[key];
                        if (data[key]) {
                            toggleComplete(el);
                        }
                    } else {
                        el.value = data[key];
                    }
                }
            });
            
            // Recalculate level if score exists
            if (data.totalScore) {
                calculateLevel();
            }
        }
        
        // Show save indicator
        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }
        
        // Export data
        function exportData() {
            const data = localStorage.getItem('transitionPlanData');
            if (!data) {
                alert('No data to export yet!');
                return;
            }
            
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `90-day-transition-plan-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
        }
        
        // Clear all data
        async function clearAllData() {
            if (confirm('Are you sure you want to reset ALL data? This cannot be undone.')) {
                try {
                    await window.storage.delete('transition-plan-data');
                } catch (error) {
                    // Continue with localStorage clear
                }
                localStorage.clear();
                location.reload();
            }
        }
        
        // Initialize when page loads
        initializeApp();
        
        // Update progress every hour
        setInterval(updateProgress, 3600000);
    </script>
</body>
</html>
